<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EmfUtil.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Nasdanika EMF</a> &gt; <a href="index.source.html" class="el_package">org.nasdanika.emf</a> &gt; <span class="el_source">EmfUtil.java</span></div><h1>EmfUtil.java</h1><pre class="source lang-java linenums">package org.nasdanika.emf;

import java.io.PrintStream;
import java.net.URL;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.Comparator;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.function.BiConsumer;
import java.util.function.Function;
import java.util.function.Predicate;
import java.util.stream.Stream;

import org.eclipse.emf.common.util.EList;
import org.eclipse.emf.common.util.URI;
import org.eclipse.emf.ecore.EAnnotation;
import org.eclipse.emf.ecore.EAttribute;
import org.eclipse.emf.ecore.EClass;
import org.eclipse.emf.ecore.EClassifier;
import org.eclipse.emf.ecore.EGenericType;
import org.eclipse.emf.ecore.EModelElement;
import org.eclipse.emf.ecore.ENamedElement;
import org.eclipse.emf.ecore.EObject;
import org.eclipse.emf.ecore.EOperation;
import org.eclipse.emf.ecore.EParameter;
import org.eclipse.emf.ecore.EReference;
import org.eclipse.emf.ecore.EStructuralFeature;
import org.eclipse.emf.ecore.ETypeParameter;
import org.eclipse.emf.ecore.resource.Resource;
import org.eclipse.emf.ecore.resource.ResourceSet;
import org.eclipse.emf.ecore.util.Diagnostician;
import org.eclipse.emf.ecore.util.EcoreUtil;
import org.nasdanika.common.BasicDiagnostic;
import org.nasdanika.common.Context;
import org.nasdanika.common.DefaultConverter;
import org.nasdanika.common.Diagnostic;
import org.nasdanika.common.Status;
import org.nasdanika.common.Util;
import org.nasdanika.emf.persistence.EObjectLoader;
import org.nasdanika.emf.persistence.FeatureCacheAdapter;
import org.nasdanika.ncore.util.NcoreUtil;

public class EmfUtil {

	public static final String ICON_KEY = &quot;icon&quot;;
	public static final String LABEL_KEY = &quot;label&quot;;
	
<span class="nc" id="L52">	public static final Comparator&lt;ENamedElement&gt; ENAMED_ELEMENT_COMPARATOR = new Comparator&lt;ENamedElement&gt;() {</span>

		@Override
		public int compare(ENamedElement a, ENamedElement b) {
<span class="nc" id="L56">			return a.getName().compareTo(b.getName());</span>
		}
		
	};

	private EmfUtil() {
		// Utility class
	}
		
	public static String getCategory(EModelElement modelElement) {
<span class="nc" id="L66">		return NcoreUtil.getNasdanikaAnnotationDetail(modelElement, &quot;category&quot;);</span>
	}

	/**
	 * Collects type dependencies for a given class - attribute types, eoperation return and exception types, eparameter types.
	 * Does not collect reference types and supertypes, as they are reported differently, but collects their generic parameter types.
	 * @param eClass
	 * @return
	 */
	public static Collection&lt;EClassifier&gt; collectTypeDependencies(EClass eClass) {
<span class="nc" id="L76">		Collection&lt;EClassifier&gt; collector = new HashSet&lt;&gt;();</span>
<span class="nc" id="L77">		Predicate&lt;EGenericType&gt; predicate = new HashSet&lt;EGenericType&gt;()::add;</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">		for (EGenericType st: eClass.getEGenericSuperTypes()) {</span>
<span class="nc" id="L79">			collector.addAll(collectGenericTypeDependencies(st, false, predicate));</span>
<span class="nc" id="L80">		}</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">		for (EReference ref: eClass.getEReferences()) {</span>
<span class="nc" id="L82">			collector.addAll(collectGenericTypeDependencies(ref.getEGenericType(), false, predicate));</span>
<span class="nc" id="L83">		}		</span>
		
<span class="nc bnc" id="L85" title="All 2 branches missed.">		for (EAttribute attr: eClass.getEAttributes()) {</span>
<span class="nc" id="L86">			collector.addAll(collectGenericTypeDependencies(attr.getEGenericType(), true, predicate));</span>
<span class="nc" id="L87">		}					</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">		for (EOperation op: eClass.getEOperations()) {</span>
<span class="nc" id="L89">			EGenericType opType = op.getEGenericType();</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">			if (opType != null) {</span>
<span class="nc" id="L91">				collector.addAll(collectGenericTypeDependencies(opType, true, predicate));</span>
			}
<span class="nc bnc" id="L93" title="All 2 branches missed.">			for (EGenericType ge: op.getEGenericExceptions()) {</span>
<span class="nc" id="L94">				collector.addAll(collectGenericTypeDependencies(ge, true, predicate));</span>
<span class="nc" id="L95">			}</span>
<span class="nc bnc" id="L96" title="All 2 branches missed.">			for (EParameter ep: op.getEParameters()) {</span>
<span class="nc" id="L97">				collector.addAll(collectGenericTypeDependencies(ep.getEGenericType(), true, predicate));</span>
<span class="nc" id="L98">			}</span>
<span class="nc" id="L99">		}					</span>
<span class="nc" id="L100">		return collector;</span>
	}
	
	/**
	 * Collects generic type dependencies, i.e. classifiers used in generic type definition.
	 * @param type Generic type
	 * @param includeEClassifier if true, include EClassifier of the type itself. Otherwise, only EClassifiers of referenced generic types - bounds, type arguments, and type parameter.
	 * @return A set of {@link EClassifier}'s.
	 */
	public static Collection&lt;EClassifier&gt; collectGenericTypeDependencies(EGenericType type, boolean includeEClassifier, Predicate&lt;EGenericType&gt; predicate) {
<span class="nc" id="L110">		Set&lt;EClassifier&gt; ret = new HashSet&lt;&gt;();</span>
<span class="nc bnc" id="L111" title="All 4 branches missed.">		if (type != null &amp;&amp; predicate.test(type)) {</span>
<span class="nc" id="L112">			EClassifier eClassifier = type.getEClassifier();</span>
<span class="nc bnc" id="L113" title="All 4 branches missed.">			if (includeEClassifier &amp;&amp; eClassifier != null) {</span>
<span class="nc" id="L114">				ret.add(eClassifier);</span>
			}
			
			// Lower bound
<span class="nc" id="L118">			ret.addAll(collectGenericTypeDependencies(type.getELowerBound(), true, predicate));</span>
			
			// Upper bound
<span class="nc" id="L121">			ret.addAll(collectGenericTypeDependencies(type.getEUpperBound(), true, predicate));</span>
			
			// Type arguments
<span class="nc bnc" id="L124" title="All 2 branches missed.">			for (EGenericType ta: type.getETypeArguments()) {</span>
<span class="nc" id="L125">				ret.addAll(collectGenericTypeDependencies(ta, true, predicate));</span>
<span class="nc" id="L126">			}</span>
			
			// Type parameter
<span class="nc" id="L129">			ETypeParameter tp = type.getETypeParameter();</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">			if (tp != null) {</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">				for (EGenericType b: tp.getEBounds()) {</span>
<span class="nc" id="L132">					ret.addAll(collectGenericTypeDependencies(b, true, predicate));					</span>
<span class="nc" id="L133">				}</span>
			}
		}
<span class="nc" id="L136">		return ret;</span>
	}
	
	/**
	 * Resolves reference relative to the resource.   
	 * @param resource Used to resolve relative references if not null.
	 * @param reference Reference.
	 * @return
	 */
	public static URI resolveReference(Resource resource, String reference) {		
<span class="nc bnc" id="L146" title="All 2 branches missed.">		URI refUri = Util.isBlank(reference) ? null : URI.createURI(reference);</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">		if (resource != null) {</span>
<span class="nc" id="L148">			URI resUri = resource.getURI();</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">			if (refUri == null) {</span>
<span class="nc" id="L150">				return resUri;</span>
			}
<span class="nc bnc" id="L152" title="All 2 branches missed.">			if (resUri.isHierarchical()) {</span>
<span class="nc" id="L153">				refUri = refUri.resolve(resUri);</span>
			}			
		}
<span class="nc" id="L156">		return refUri;</span>
	}
	
	/**
	 * Provides access to documentation and its location for resolving resource references. 
	 * @author Pavel
	 *
	 */
	public interface EModelElementDocumentation {
		
		/**
		 * @return Documentation loaded from an annotation of external resource.
		 */
		String getDocumentation();
		
		/**
		 * @return URI of the model resource for documentation loaded from an annotation, URI of a resource if loaded from a resource.
		 */
		URI getLocation();
		
		static EModelElementDocumentation from(String documentation, URI location) {
<span class="nc" id="L177">			return new EModelElementDocumentation() {</span>
				
				@Override
				public URI getLocation() {
<span class="nc" id="L181">					return location;</span>
				}
				
				@Override
				public String getDocumentation() {
<span class="nc" id="L186">					return documentation;</span>
				}
			}; 
		}		
		
	}
	
	/**
	 * Loads element documentation from a documentation resource specified in documentation-reference nasdanika (urn:org.nasdanika) annotation resolved relative to the 
	 * model element resource. 
	 * @param modelElement
	 * @return
	 */
	public static EModelElementDocumentation getDocumentation(EModelElement modelElement) {
<span class="nc" id="L200">		String modelDoc = EcoreUtil.getDocumentation(modelElement);</span>
<span class="nc bnc" id="L201" title="All 2 branches missed.">		if (!Util.isBlank(modelDoc)) {</span>
<span class="nc" id="L202">			Resource res = modelElement.eResource();</span>
<span class="nc bnc" id="L203" title="All 2 branches missed.">			return EModelElementDocumentation.from(modelDoc, res == null ? null : res.getURI());			</span>
		}
		
<span class="nc" id="L206">		EAnnotation nasdanikaAnnotation = NcoreUtil.getNasdanikaAnnotation(modelElement);</span>
<span class="nc bnc" id="L207" title="All 2 branches missed.">		if (nasdanikaAnnotation != null) {</span>
<span class="nc" id="L208">			String docRef = nasdanikaAnnotation.getDetails().get(&quot;documentation-reference&quot;);</span>
<span class="nc bnc" id="L209" title="All 2 branches missed.">			if (!Util.isBlank(docRef)) {</span>
				try {
<span class="nc" id="L211">					URI refUri = resolveReference(modelElement.eResource(), docRef);</span>
<span class="nc bnc" id="L212" title="All 2 branches missed.">					if (Util.isBlank(refUri.scheme())) {</span>
<span class="nc" id="L213">						return null;			</span>
					}

<span class="nc" id="L216">					String doc = DefaultConverter.INSTANCE.toString(new URL(refUri.toString()).openStream());</span>
<span class="nc" id="L217">					return EModelElementDocumentation.from(doc, refUri);</span>
<span class="nc" id="L218">				} catch (Exception e) {</span>
<span class="nc" id="L219">					e.printStackTrace();</span>
<span class="nc" id="L220">					return EModelElementDocumentation.from(&quot;&lt;div class='nsd-error'&gt;Error loading documentation: &quot; + e + &quot;&lt;/div&gt;&quot;, null);</span>
				}
			}
		}
		
<span class="nc" id="L225">		return null;</span>
	}
	
	/**
	 * Loads element load documentation from load-doc annotation of or a documentation resource specified in load-doc-reference nasdanika (urn:org.nasdanika) annotation resolved relative to the 
	 * model element resource. 
	 * @param modelElement
	 * @return
	 */
	public static EModelElementDocumentation getLoadDocumentation(EModelElement modelElement) {
<span class="nc" id="L235">		EAnnotation nasdanikaAnnotation = NcoreUtil.getNasdanikaAnnotation(modelElement);</span>
<span class="nc bnc" id="L236" title="All 2 branches missed.">		if (nasdanikaAnnotation != null) {</span>
<span class="nc" id="L237">			String docRef = nasdanikaAnnotation.getDetails().get(EObjectLoader.LOAD_DOC_REF);</span>
<span class="nc bnc" id="L238" title="All 2 branches missed.">			if (!Util.isBlank(docRef)) {</span>
				try {
<span class="nc" id="L240">					URI refUri = resolveReference(modelElement.eResource(), docRef);</span>
<span class="nc bnc" id="L241" title="All 2 branches missed.">					if (Util.isBlank(refUri.scheme())) {</span>
<span class="nc" id="L242">						return null;			</span>
					}

<span class="nc" id="L245">					String doc = DefaultConverter.INSTANCE.toString(new URL(refUri.toString()).openStream());</span>
<span class="nc" id="L246">					return EModelElementDocumentation.from(doc, refUri);</span>
<span class="nc" id="L247">				} catch (Exception e) {</span>
<span class="nc" id="L248">					e.printStackTrace();</span>
<span class="nc" id="L249">					return EModelElementDocumentation.from(&quot;&lt;div class='nsd-error'&gt;Error loading documentation: &quot; + e + &quot;&lt;/div&gt;&quot;, null);</span>
				}
			}
			
<span class="nc" id="L253">			String loadDoc = nasdanikaAnnotation.getDetails().get(EObjectLoader.LOAD_DOC);</span>
<span class="nc bnc" id="L254" title="All 2 branches missed.">			if (Util.isBlank(loadDoc)) {</span>
<span class="nc" id="L255">				return null;</span>
			}
<span class="nc" id="L257">			return new EModelElementDocumentation() {</span>
				
				@Override
				public URI getLocation() {
<span class="nc" id="L261">					Resource res = modelElement.eResource();</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">					return res == null ? null : res.getURI();</span>
				}
				
				@Override
				public String getDocumentation() {
<span class="nc" id="L267">					return loadDoc;</span>
				}
			};
		}
		
<span class="nc" id="L272">		return null;</span>
	}
	
	
	public static Diagnostic wrap(org.eclipse.emf.common.util.Diagnostic diagnostic) {
		Status status;
<span class="nc bnc" id="L278" title="All 5 branches missed.">		switch (diagnostic.getSeverity()) {</span>
		case org.eclipse.emf.common.util.Diagnostic.CANCEL:
<span class="nc" id="L280">			status = Status.CANCEL;</span>
<span class="nc" id="L281">			break;</span>
		case org.eclipse.emf.common.util.Diagnostic.INFO:
<span class="nc" id="L283">			status = Status.INFO;</span>
<span class="nc" id="L284">			break;</span>
		case org.eclipse.emf.common.util.Diagnostic.OK:
<span class="nc" id="L286">			status = Status.SUCCESS;</span>
<span class="nc" id="L287">			break;</span>
		case org.eclipse.emf.common.util.Diagnostic.WARNING:
<span class="nc" id="L289">			status = Status.WARNING;</span>
<span class="nc" id="L290">			break;</span>
		case org.eclipse.emf.common.util.Diagnostic.ERROR:
		default:
<span class="nc" id="L293">			status = Status.ERROR;</span>
			break;
			
		}
<span class="nc" id="L297">		BasicDiagnostic ret = new BasicDiagnostic(status, diagnostic.getMessage(), diagnostic);</span>
<span class="nc bnc" id="L298" title="All 2 branches missed.">		for (org.eclipse.emf.common.util.Diagnostic child: diagnostic.getChildren()) {</span>
<span class="nc" id="L299">			ret.add(wrap(child));</span>
<span class="nc" id="L300">		}</span>
<span class="nc" id="L301">		return ret;</span>
	}

	public static &lt;K, V extends EObject&gt; Map&lt;K, List&lt;V&gt;&gt; groupBy(Collection&lt;V&gt; elements, EStructuralFeature... keyFeatures) {
		@SuppressWarnings(&quot;unchecked&quot;)
<span class="nc" id="L306">		Function&lt;EObject,K&gt; classifier = e -&gt; {</span>
<span class="nc bnc" id="L307" title="All 2 branches missed.">			if (e == null) {</span>
<span class="nc" id="L308">				return null;</span>
			}
<span class="nc bnc" id="L310" title="All 2 branches missed.">			if (keyFeatures.length == 1) {</span>
<span class="nc" id="L311">				return (K) e.eGet(keyFeatures[0]);</span>
			}
<span class="nc" id="L313">			List&lt;Object&gt; key = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L314" title="All 2 branches missed.">			for (EStructuralFeature keyFeature: keyFeatures) {</span>
<span class="nc" id="L315">				key.add(e.eGet(keyFeature));</span>
			}
<span class="nc" id="L317">			return (K) key;</span>
		};
<span class="nc" id="L319">		return Util.groupBy(elements, classifier);</span>
	}
	
	/**
	 * Finds objects referencing the argument object (target) via the specified reference.
	 * @param &lt;T&gt;
	 * @param target Referenced object
	 * @param eReference Reference
	 * @return Object referencing this one via the specified reference.
	 */
	public static &lt;T extends EObject&gt; EList&lt;T&gt; getReferrers(EObject target, EReference eReference) {
<span class="nc" id="L330">		return NcoreUtil.getReferrers(target, eReference);</span>
	}
	
	public static void dumpDiagnostic(org.eclipse.emf.common.util.Diagnostic d, int indent, PrintStream out) {
<span class="nc bnc" id="L334" title="All 2 branches missed.">		for (int i=0; i &lt; indent; ++i) {</span>
<span class="nc" id="L335">			out.print(&quot;    &quot;);</span>
		}
<span class="nc" id="L337">		out.println(toString(d));</span>
<span class="nc bnc" id="L338" title="All 2 branches missed.">	    if (d.getChildren() != null) {</span>
<span class="nc" id="L339">	    	d.getChildren().forEach(c -&gt; dumpDiagnostic(c, indent + 1, out));</span>
	    }		
<span class="nc" id="L341">	}</span>
	
	static String toString(org.eclipse.emf.common.util.Diagnostic d) {
<span class="nc" id="L344">		StringBuilder result = new StringBuilder();</span>
<span class="nc bnc" id="L345" title="All 6 branches missed.">		switch (d.getSeverity()) {</span>
		case org.eclipse.emf.common.util.Diagnostic.OK:
<span class="nc" id="L347">			result.append(&quot;OK&quot;);</span>
<span class="nc" id="L348">			break;</span>
		case org.eclipse.emf.common.util.Diagnostic.INFO:
<span class="nc" id="L350">			result.append(&quot;INFO&quot;);</span>
<span class="nc" id="L351">			break;</span>
		case org.eclipse.emf.common.util.Diagnostic.WARNING:
<span class="nc" id="L353">			result.append(&quot;WARNING&quot;);</span>
<span class="nc" id="L354">			break;</span>
		case org.eclipse.emf.common.util.Diagnostic.ERROR:
<span class="nc" id="L356">			result.append(&quot;ERROR&quot;);</span>
<span class="nc" id="L357">			break;</span>
		case org.eclipse.emf.common.util.Diagnostic.CANCEL:
<span class="nc" id="L359">			result.append(&quot;CANCEL&quot;);</span>
<span class="nc" id="L360">			break;</span>
		default:
<span class="nc" id="L362">			result.append(Integer.toHexString(d.getSeverity()));</span>
			break;
		}

<span class="nc" id="L366">		result.append(&quot; source=&quot;);</span>
<span class="nc" id="L367">		result.append(d.getSource());</span>

<span class="nc" id="L369">		result.append(&quot; code=&quot;);</span>
<span class="nc" id="L370">		result.append(d.getCode());</span>

<span class="nc" id="L372">		result.append(' ');</span>
<span class="nc" id="L373">		result.append(d.getMessage());</span>

<span class="nc bnc" id="L375" title="All 2 branches missed.">		if (d.getData() != null) {</span>
<span class="nc" id="L376">			result.append(&quot; data=&quot;);</span>
<span class="nc" id="L377">			result.append(d.getData());</span>
		}

<span class="nc" id="L380">		return result.toString();</span>
	}		

	/**
	 * Resolves all proxies, clears feature caches and then diagnoses the resource set.
	 * @param resourceSet
	 * @param context
	 * @return
	 */
	public static org.eclipse.emf.common.util.Diagnostic resolveClearCacheAndDiagnose(ResourceSet resourceSet, Context context) {
<span class="nc" id="L390">		EcoreUtil.resolveAll(resourceSet);</span>
<span class="nc" id="L391">		resourceSet.getAllContents().forEachRemaining(notifier -&gt; notifier.eNotify(FeatureCacheAdapter.CLEAR_CACHE));</span>

<span class="nc" id="L393">		Diagnostician diagnostician = new Diagnostician();</span>
<span class="nc" id="L394">		org.eclipse.emf.common.util.BasicDiagnostic ret = new org.eclipse.emf.common.util.BasicDiagnostic();</span>
<span class="nc" id="L395">		Map&lt;Class&lt;Context&gt;, Context&gt; diagnosticContext = Collections.singletonMap(Context.class, context);</span>
<span class="nc bnc" id="L396" title="All 2 branches missed.">		for (Resource resource: resourceSet.getResources()) {</span>
<span class="nc" id="L397">			org.eclipse.emf.common.util.BasicDiagnostic resourceDiagnostic = new org.eclipse.emf.common.util.BasicDiagnostic(resource.getURI().toString(), 0, &quot;Resource diagnostic&quot;, new Object[] {resource});</span>
<span class="nc bnc" id="L398" title="All 2 branches missed.">			for (EObject e: resource.getContents()) {</span>
<span class="nc" id="L399">				org.eclipse.emf.common.util.Diagnostic diagnostic = diagnostician.validate(e, diagnosticContext);</span>
<span class="nc" id="L400">				resourceDiagnostic.add(diagnostic);</span>
<span class="nc" id="L401">			}</span>
<span class="nc" id="L402">			ret.add(resourceDiagnostic);</span>
<span class="nc" id="L403">		}</span>
<span class="nc" id="L404">		return ret;</span>
	}

	/**
	 * Diagnoses the resource set.
	 * @param resourceSet
	 * @param context
	 * @param diagnosticConsumer consumer of diagnostics.
	 * @return
	 */
	public static void diagnose(ResourceSet resourceSet, Context context, BiConsumer&lt;EObject, org.eclipse.emf.common.util.Diagnostic&gt; diagnosticConsumer) {
<span class="nc" id="L415">		EcoreUtil.resolveAll(resourceSet);</span>
<span class="nc" id="L416">		resourceSet.getAllContents().forEachRemaining(notifier -&gt; notifier.eNotify(FeatureCacheAdapter.CLEAR_CACHE));</span>

<span class="nc" id="L418">		Diagnostician diagnostician = new Diagnostician();</span>
<span class="nc" id="L419">		Map&lt;Class&lt;Context&gt;, Context&gt; diagnosticContext = Collections.singletonMap(Context.class, context);</span>
<span class="nc bnc" id="L420" title="All 2 branches missed.">		for (Resource resource: resourceSet.getResources()) {</span>
<span class="nc bnc" id="L421" title="All 2 branches missed.">			for (EObject e: resource.getContents()) {</span>
<span class="nc" id="L422">				diagnosticConsumer.accept(e, diagnostician.validate(e, diagnosticContext));</span>
<span class="nc" id="L423">			}</span>
<span class="nc" id="L424">		}</span>
<span class="nc" id="L425">	}	</span>
	
	/**
	 * Resolves URI against the base if base is not null.
	 * @param uri
	 * @param base
	 * @return
	 */
	public static URI resolve(URI uri, URI base) {
<span class="nc bnc" id="L434" title="All 2 branches missed.">		return base == null ? uri : uri.resolve(base);</span>
	}
	
	public static Stream&lt;EObject&gt; ancestors(EObject eObj) {
<span class="nc bnc" id="L438" title="All 2 branches missed.">		if (eObj == null) {</span>
<span class="nc" id="L439">			return Stream.empty();</span>
		}
		
<span class="nc" id="L442">		EObject ec = eObj.eContainer(); </span>
<span class="nc bnc" id="L443" title="All 2 branches missed.">		if (ec == null) {</span>
<span class="nc" id="L444">			return Stream.empty();</span>
		}
<span class="nc" id="L446">		return Stream.concat(Stream.of(ec), ancestors(ec));</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>