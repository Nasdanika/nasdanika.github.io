<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DiagnosticHelper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Nasdanika EMF</a> &gt; <a href="index.source.html" class="el_package">org.nasdanika.emf</a> &gt; <span class="el_source">DiagnosticHelper.java</span></div><h1>DiagnosticHelper.java</h1><pre class="source lang-java linenums">package org.nasdanika.emf;

import java.util.ArrayList;
import java.util.List;

import org.eclipse.emf.common.util.BasicDiagnostic;
import org.eclipse.emf.common.util.Diagnostic;
import org.eclipse.emf.common.util.DiagnosticChain;
import org.eclipse.emf.ecore.EObject;
import org.eclipse.emf.ecore.EStructuralFeature;

/**
 * Helper class to reduce amount of diagnostic/validation code.
 * @author Pavel Vlasov
 *
 */
public class DiagnosticHelper {
	
	private String source;
	private int code;
	private DiagnosticChain diagnostics;
	private Object owner;

	/**
	 * DiagnosticHelper shall typically be created at the top of validate() method.
	 * @param diagnostics
	 * @param source
	 * @param code
	 * @param owner
	 */
<span class="nc" id="L31">	public DiagnosticHelper(DiagnosticChain diagnostics, String source, int code, Object owner) {</span>
<span class="nc" id="L32">		this.diagnostics = diagnostics;</span>
<span class="nc" id="L33">		this.source = source;</span>
<span class="nc" id="L34">		this.code = code;</span>
<span class="nc" id="L35">		this.owner = owner;</span>
<span class="nc" id="L36">	}</span>
	
<span class="nc" id="L38">	private boolean success = true;</span>
	
	/**
	 * @return true if there were no error level diagnostics.
	 */
	public boolean isSuccess() {
<span class="nc" id="L44">		return success;</span>
	}
	
	/**
	 * Adds diagnostic.
	 * @param severity
	 * @param message Diagnostic message.
	 * @param messageKey Message key for localization, can be null.
	 * @param feature Feature under diagnostic. Can be null.
	 */
	public void addDiagnostic(int severity, String message, String messageKey, EStructuralFeature feature) {
<span class="nc bnc" id="L55" title="All 2 branches missed.">		if (diagnostics != null) {</span>
<span class="nc bnc" id="L56" title="All 6 branches missed.">			if (feature != null &amp;&amp; owner instanceof EObject &amp;&amp; !((EObject) owner).eClass().getEAllStructuralFeatures().contains(feature)) {</span>
<span class="nc" id="L57">				throw new IllegalArgumentException(&quot;EStructuralFeature &quot;+feature+&quot; does not belong to owner's EClass &quot;+ ((EObject) owner).eClass());</span>
			}
<span class="nc" id="L59">			List&lt;Object&gt; data = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L60">			data.add(owner);</span>
<span class="nc bnc" id="L61" title="All 2 branches missed.">			if (feature != null) {</span>
<span class="nc" id="L62">				data.add(feature);</span>
			}
<span class="nc bnc" id="L64" title="All 2 branches missed.">			if (messageKey != null) {</span>
<span class="nc" id="L65">				data.add(messageKey);</span>
			}
<span class="nc" id="L67">			diagnostics.add(new BasicDiagnostic(severity, source, code, message, data.toArray()));</span>
		
<span class="nc bnc" id="L69" title="All 2 branches missed.">			if (Diagnostic.ERROR == severity) {</span>
<span class="nc" id="L70">				success = false;</span>
			}
			
		}
<span class="nc" id="L74">	}</span>
	
	public void error(String message, String messageKey, EStructuralFeature feature) {
<span class="nc" id="L77">		addDiagnostic(Diagnostic.ERROR, message, messageKey, feature);</span>
<span class="nc" id="L78">	}</span>
	
	public void error(String message, String messageKey) {
<span class="nc" id="L81">		error(message, messageKey, null);</span>
<span class="nc" id="L82">	}</span>
	
	public void error(String message, EStructuralFeature feature) {
<span class="nc" id="L85">		error(message, null, feature);</span>
<span class="nc" id="L86">	}</span>
	
	public void error(String message) {
<span class="nc" id="L89">		error(message, null, null);</span>
<span class="nc" id="L90">	}</span>
	
	public void warning(String message, String messageKey, EStructuralFeature feature) {
<span class="nc" id="L93">		addDiagnostic(Diagnostic.WARNING, message, messageKey, feature);</span>
<span class="nc" id="L94">	}</span>
	
	public void warning(String message, String messageKey) {
<span class="nc" id="L97">		warning(message, messageKey, null);</span>
<span class="nc" id="L98">	}</span>
	
	public void warning(String message, EStructuralFeature feature) {
<span class="nc" id="L101">		warning(message, null, feature);</span>
<span class="nc" id="L102">	}</span>
	
	public void warning(String message) {
<span class="nc" id="L105">		warning(message, null, null);</span>
<span class="nc" id="L106">	}</span>
	
	public void info(String message, String messageKey, EStructuralFeature feature) {
<span class="nc" id="L109">		addDiagnostic(Diagnostic.INFO, message, messageKey, feature);</span>
<span class="nc" id="L110">	}</span>
	
	public void info(String message, String messageKey) {
<span class="nc" id="L113">		info(message, messageKey, null);</span>
<span class="nc" id="L114">	}</span>
	
	public void info(String message, EStructuralFeature feature) {
<span class="nc" id="L117">		info(message, null, feature);</span>
<span class="nc" id="L118">	}</span>
	
	public void info(String message) {
<span class="nc" id="L121">		info(message, null, null);</span>
<span class="nc" id="L122">	}</span>
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>