<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Diagnostic.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Nasdanika Common</a> &gt; <a href="index.source.html" class="el_package">org.nasdanika.common</a> &gt; <span class="el_source">Diagnostic.java</span></div><h1>Diagnostic.java</h1><pre class="source lang-java linenums">package org.nasdanika.common;

import java.io.PrintStream;
import java.util.List;

public interface Diagnostic {
	
	Status getStatus();
	
	String getMessage();
	
	List&lt;Object&gt; getData();
	
	List&lt;Diagnostic&gt; getChildren();
	
	/**
	 * Throws {@link DiagnosticException} if status is {@link Status}.ERROR
	 * @param message
	 */
	default void checkError(String message) {
<span class="pc bpc" id="L21" title="1 of 2 branches missed.">		if (getStatus() == Status.ERROR) {</span>
<span class="nc" id="L22">			throw new DiagnosticException(message, this);</span>
		}
<span class="fc" id="L24">	}</span>
	
	static Diagnostic compose(String message, Diagnostic... diagnostics) {
<span class="nc bnc" id="L27" title="All 4 branches missed.">		if (diagnostics.length == 1 &amp;&amp; diagnostics[0] != null) {</span>
<span class="nc" id="L28">			return diagnostics[0];</span>
		}
		
<span class="nc" id="L31">		BasicDiagnostic ret = new BasicDiagnostic(Status.INFO, message);</span>
<span class="nc bnc" id="L32" title="All 2 branches missed.">		for (Diagnostic diagnostic: diagnostics) {</span>
<span class="nc" id="L33">			ret.add(diagnostic);</span>
		}
<span class="nc" id="L35">		return ret;</span>
	}
	
	default void dump(PrintStream out, int indent, Status... statuses) {
<span class="nc bnc" id="L39" title="All 2 branches missed.">		for (int i=0; i &lt; indent; ++i) {</span>
<span class="nc" id="L40">			out.print(&quot;    &quot;);</span>
		}
				
<span class="nc" id="L43">		Status status = getStatus();</span>
<span class="nc bnc" id="L44" title="All 2 branches missed.">		boolean match = statuses.length == 0;</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">		for (Status s: statuses) {</span>
<span class="nc bnc" id="L46" title="All 2 branches missed.">			if (s == status) {</span>
<span class="nc" id="L47">				match = true;</span>
<span class="nc" id="L48">				break;</span>
			}
		}
<span class="nc bnc" id="L51" title="All 2 branches missed.">		if (match) {</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">			if (status != null) {</span>
				// TODO - ANSI coloring of statuses
<span class="nc" id="L54">				out.print(status.name());</span>
<span class="nc" id="L55">				out.print(' ');</span>
			}
	
<span class="nc" id="L58">			out.print(getMessage());</span>
	
<span class="nc" id="L60">			List&lt;Object&gt; data = getData();</span>
<span class="nc bnc" id="L61" title="All 2 branches missed.">			if (data != null) {</span>
<span class="nc" id="L62">				out.print(&quot; data=&quot;);</span>
<span class="nc" id="L63">				out.print(getData());</span>
<span class="nc bnc" id="L64" title="All 2 branches missed.">				for (Object de: data) {</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">					if (de instanceof Throwable) {</span>
<span class="nc" id="L66">						((Throwable) de).printStackTrace(out);</span>
					}
<span class="nc" id="L68">				}</span>
			}		
			
<span class="nc" id="L71">			out.println();</span>
			
<span class="nc" id="L73">		    List&lt;Diagnostic&gt; children = getChildren();</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">			if (children != null) {</span>
<span class="nc" id="L75">		    	children.forEach(c -&gt; c.dump(out, indent + 1, statuses));</span>
		    }
		}		
<span class="nc" id="L78">	}</span>
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>